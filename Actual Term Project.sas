*Reset;
dm 'log' clear;
resetline;

*Set path;
libname tpr "H:\673 Homework";

* Change the path in the following LET statement to the file 
  folder where you have the CSV files saved.  Note that there are 
  no quotation marks and the path ends with a backslash;
%let path=H:\Group Project Data\;
data stack;
year=1990;
run;

%macro mread(fyear);

data temp;
infile "&path.ACSST5Y&fyear..S2701-Data.csv"
	dsd missover firstobs=3;
input
GEO_ID:$14.
NAME:$120.
S2701_C01_001E
S2701_C01_001M
S2701_C01_002E
S2701_C01_002M
S2701_C01_003E
S2701_C01_003M
S2701_C01_004E
S2701_C01_004M
S2701_C01_005E
S2701_C01_005M
S2701_C01_006E
S2701_C01_006M
S2701_C01_007E
S2701_C01_007M
S2701_C01_008E
S2701_C01_008M
S2701_C01_009E
S2701_C01_009M
S2701_C01_010E
S2701_C01_010M
S2701_C01_011E
S2701_C01_011M
S2701_C01_012E
S2701_C01_012M
S2701_C01_013E
S2701_C01_013M
S2701_C01_014E
S2701_C01_014M
S2701_C01_015E
S2701_C01_015M
S2701_C01_016E
S2701_C01_016M
S2701_C01_017E
S2701_C01_017M
S2701_C01_018E
S2701_C01_018M
S2701_C01_019E
S2701_C01_019M
S2701_C01_020E
S2701_C01_020M
S2701_C01_021E
S2701_C01_021M
S2701_C01_022E
S2701_C01_022M
S2701_C01_023E
S2701_C01_023M
S2701_C01_024E
S2701_C01_024M
S2701_C01_025E
S2701_C01_025M
S2701_C01_026E
S2701_C01_026M
S2701_C01_027E
S2701_C01_027M
S2701_C01_028E
S2701_C01_028M
S2701_C01_029E
S2701_C01_029M
S2701_C01_030E
S2701_C01_030M
S2701_C01_031E
S2701_C01_031M
S2701_C01_032E
S2701_C01_032M
S2701_C01_033E
S2701_C01_033M
S2701_C01_034E
S2701_C01_034M
S2701_C01_035E
S2701_C01_035M
S2701_C01_036E
S2701_C01_036M
S2701_C01_037E
S2701_C01_037M
S2701_C01_038E
S2701_C01_038M
S2701_C01_039E
S2701_C01_039M
S2701_C01_040E
S2701_C01_040M
S2701_C01_041E
S2701_C01_041M
S2701_C01_042E
S2701_C01_042M
S2701_C01_043E
S2701_C01_043M
S2701_C01_044E
S2701_C01_044M
S2701_C01_045E
S2701_C01_045M
S2701_C01_046E
S2701_C01_046M
S2701_C01_047E
S2701_C01_047M
S2701_C01_048E
S2701_C01_048M
S2701_C01_049E
S2701_C01_049M
S2701_C01_050E
S2701_C01_050M
S2701_C01_051E
S2701_C01_051M
S2701_C01_052E
S2701_C01_052M
S2701_C01_053E
S2701_C01_053M
S2701_C01_054E
S2701_C01_054M
S2701_C01_055E
S2701_C01_055M
S2701_C01_056E
S2701_C01_056M
S2701_C01_057E
S2701_C01_057M
S2701_C01_058E
S2701_C01_058M
S2701_C01_059E
S2701_C01_059M
S2701_C01_060E
S2701_C01_060M
S2701_C01_061E
S2701_C01_061M
S2701_C02_001E
S2701_C02_001M
S2701_C02_002E
S2701_C02_002M
S2701_C02_003E
S2701_C02_003M
S2701_C02_004E
S2701_C02_004M
S2701_C02_005E
S2701_C02_005M
S2701_C02_006E
S2701_C02_006M
S2701_C02_007E
S2701_C02_007M
S2701_C02_008E
S2701_C02_008M
S2701_C02_009E
S2701_C02_009M
S2701_C02_010E
S2701_C02_010M
S2701_C02_011E
S2701_C02_011M
S2701_C02_012E
S2701_C02_012M
S2701_C02_013E
S2701_C02_013M
S2701_C02_014E
S2701_C02_014M
S2701_C02_015E
S2701_C02_015M
S2701_C02_016E
S2701_C02_016M
S2701_C02_017E
S2701_C02_017M
S2701_C02_018E
S2701_C02_018M
S2701_C02_019E
S2701_C02_019M
S2701_C02_020E
S2701_C02_020M
S2701_C02_021E
S2701_C02_021M
S2701_C02_022E
S2701_C02_022M
S2701_C02_023E
S2701_C02_023M
S2701_C02_024E
S2701_C02_024M
S2701_C02_025E
S2701_C02_025M
S2701_C02_026E
S2701_C02_026M
S2701_C02_027E
S2701_C02_027M
S2701_C02_028E
S2701_C02_028M
S2701_C02_029E
S2701_C02_029M
S2701_C02_030E
S2701_C02_030M
S2701_C02_031E
S2701_C02_031M
S2701_C02_032E
S2701_C02_032M
S2701_C02_033E
S2701_C02_033M
S2701_C02_034E
S2701_C02_034M
S2701_C02_035E
S2701_C02_035M
S2701_C02_036E
S2701_C02_036M
S2701_C02_037E
S2701_C02_037M
S2701_C02_038E
S2701_C02_038M
S2701_C02_039E
S2701_C02_039M
S2701_C02_040E
S2701_C02_040M
S2701_C02_041E
S2701_C02_041M
S2701_C02_042E
S2701_C02_042M
S2701_C02_043E
S2701_C02_043M
S2701_C02_044E
S2701_C02_044M
S2701_C02_045E
S2701_C02_045M
S2701_C02_046E
S2701_C02_046M
S2701_C02_047E
S2701_C02_047M
S2701_C02_048E
S2701_C02_048M
S2701_C02_049E
S2701_C02_049M
S2701_C02_050E
S2701_C02_050M
S2701_C02_051E
S2701_C02_051M
S2701_C02_052E
S2701_C02_052M
S2701_C02_053E
S2701_C02_053M
S2701_C02_054E
S2701_C02_054M
S2701_C02_055E
S2701_C02_055M
S2701_C02_056E
S2701_C02_056M
S2701_C02_057E
S2701_C02_057M
S2701_C02_058E
S2701_C02_058M
S2701_C02_059E
S2701_C02_059M
S2701_C02_060E
S2701_C02_060M
S2701_C02_061E
S2701_C02_061M
S2701_C03_001E
S2701_C03_001M
S2701_C03_002E
S2701_C03_002M
S2701_C03_003E
S2701_C03_003M
S2701_C03_004E
S2701_C03_004M
S2701_C03_005E
S2701_C03_005M
S2701_C03_006E
S2701_C03_006M
S2701_C03_007E
S2701_C03_007M
S2701_C03_008E
S2701_C03_008M
S2701_C03_009E
S2701_C03_009M
S2701_C03_010E
S2701_C03_010M
S2701_C03_011E
S2701_C03_011M
S2701_C03_012E
S2701_C03_012M
S2701_C03_013E
S2701_C03_013M
S2701_C03_014E
S2701_C03_014M
S2701_C03_015E
S2701_C03_015M
S2701_C03_016E
S2701_C03_016M
S2701_C03_017E
S2701_C03_017M
S2701_C03_018E
S2701_C03_018M
S2701_C03_019E
S2701_C03_019M
S2701_C03_020E
S2701_C03_020M
S2701_C03_021E
S2701_C03_021M
S2701_C03_022E
S2701_C03_022M
S2701_C03_023E
S2701_C03_023M
S2701_C03_024E
S2701_C03_024M
S2701_C03_025E
S2701_C03_025M
S2701_C03_026E
S2701_C03_026M
S2701_C03_027E
S2701_C03_027M
S2701_C03_028E
S2701_C03_028M
S2701_C03_029E
S2701_C03_029M
S2701_C03_030E
S2701_C03_030M
S2701_C03_031E
S2701_C03_031M
S2701_C03_032E
S2701_C03_032M
S2701_C03_033E
S2701_C03_033M
S2701_C03_034E
S2701_C03_034M
S2701_C03_035E
S2701_C03_035M
S2701_C03_036E
S2701_C03_036M
S2701_C03_037E
S2701_C03_037M
S2701_C03_038E
S2701_C03_038M
S2701_C03_039E
S2701_C03_039M
S2701_C03_040E
S2701_C03_040M
S2701_C03_041E
S2701_C03_041M
S2701_C03_042E
S2701_C03_042M
S2701_C03_043E
S2701_C03_043M
S2701_C03_044E
S2701_C03_044M
S2701_C03_045E
S2701_C03_045M
S2701_C03_046E
S2701_C03_046M
S2701_C03_047E
S2701_C03_047M
S2701_C03_048E
S2701_C03_048M
S2701_C03_049E
S2701_C03_049M
S2701_C03_050E
S2701_C03_050M
S2701_C03_051E
S2701_C03_051M
S2701_C03_052E
S2701_C03_052M
S2701_C03_053E
S2701_C03_053M
S2701_C03_054E
S2701_C03_054M
S2701_C03_055E
S2701_C03_055M
S2701_C03_056E
S2701_C03_056M
S2701_C03_057E
S2701_C03_057M
S2701_C03_058E
S2701_C03_058M
S2701_C03_059E
S2701_C03_059M
S2701_C03_060E
S2701_C03_060M
S2701_C03_061E
S2701_C03_061M
S2701_C04_001E
S2701_C04_001M
S2701_C04_002E
S2701_C04_002M
S2701_C04_003E
S2701_C04_003M
S2701_C04_004E
S2701_C04_004M
S2701_C04_005E
S2701_C04_005M
S2701_C04_006E
S2701_C04_006M
S2701_C04_007E
S2701_C04_007M
S2701_C04_008E
S2701_C04_008M
S2701_C04_009E
S2701_C04_009M
S2701_C04_010E
S2701_C04_010M
S2701_C04_011E
S2701_C04_011M
S2701_C04_012E
S2701_C04_012M
S2701_C04_013E
S2701_C04_013M
S2701_C04_014E
S2701_C04_014M
S2701_C04_015E
S2701_C04_015M
S2701_C04_016E
S2701_C04_016M
S2701_C04_017E
S2701_C04_017M
S2701_C04_018E
S2701_C04_018M
S2701_C04_019E
S2701_C04_019M
S2701_C04_020E
S2701_C04_020M
S2701_C04_021E
S2701_C04_021M
S2701_C04_022E
S2701_C04_022M
S2701_C04_023E
S2701_C04_023M
S2701_C04_024E
S2701_C04_024M
S2701_C04_025E
S2701_C04_025M
S2701_C04_026E
S2701_C04_026M
S2701_C04_027E
S2701_C04_027M
S2701_C04_028E
S2701_C04_028M
S2701_C04_029E
S2701_C04_029M
S2701_C04_030E
S2701_C04_030M
S2701_C04_031E
S2701_C04_031M
S2701_C04_032E
S2701_C04_032M
S2701_C04_033E
S2701_C04_033M
S2701_C04_034E
S2701_C04_034M
S2701_C04_035E
S2701_C04_035M
S2701_C04_036E
S2701_C04_036M
S2701_C04_037E
S2701_C04_037M
S2701_C04_038E
S2701_C04_038M
S2701_C04_039E
S2701_C04_039M
S2701_C04_040E
S2701_C04_040M
S2701_C04_041E
S2701_C04_041M
S2701_C04_042E
S2701_C04_042M
S2701_C04_043E
S2701_C04_043M
S2701_C04_044E
S2701_C04_044M
S2701_C04_045E
S2701_C04_045M
S2701_C04_046E
S2701_C04_046M
S2701_C04_047E
S2701_C04_047M
S2701_C04_048E
S2701_C04_048M
S2701_C04_049E
S2701_C04_049M
S2701_C04_050E
S2701_C04_050M
S2701_C04_051E
S2701_C04_051M
S2701_C04_052E
S2701_C04_052M
S2701_C04_053E
S2701_C04_053M
S2701_C04_054E
S2701_C04_054M
S2701_C04_055E
S2701_C04_055M
S2701_C04_056E
S2701_C04_056M
S2701_C04_057E
S2701_C04_057M
S2701_C04_058E
S2701_C04_058M
S2701_C04_059E
S2701_C04_059M
S2701_C04_060E
S2701_C04_060M
S2701_C04_061E
S2701_C04_061M
S2701_C05_001E
S2701_C05_001M
S2701_C05_002E
S2701_C05_002M
S2701_C05_003E
S2701_C05_003M
S2701_C05_004E
S2701_C05_004M
S2701_C05_005E
S2701_C05_005M
S2701_C05_006E
S2701_C05_006M
S2701_C05_007E
S2701_C05_007M
S2701_C05_008E
S2701_C05_008M
S2701_C05_009E
S2701_C05_009M
S2701_C05_010E
S2701_C05_010M
S2701_C05_011E
S2701_C05_011M
S2701_C05_012E
S2701_C05_012M
S2701_C05_013E
S2701_C05_013M
S2701_C05_014E
S2701_C05_014M
S2701_C05_015E
S2701_C05_015M
S2701_C05_016E
S2701_C05_016M
S2701_C05_017E
S2701_C05_017M
S2701_C05_018E
S2701_C05_018M
S2701_C05_019E
S2701_C05_019M
S2701_C05_020E
S2701_C05_020M
S2701_C05_021E
S2701_C05_021M
S2701_C05_022E
S2701_C05_022M
S2701_C05_023E
S2701_C05_023M
S2701_C05_024E
S2701_C05_024M
S2701_C05_025E
S2701_C05_025M
S2701_C05_026E
S2701_C05_026M
S2701_C05_027E
S2701_C05_027M
S2701_C05_028E
S2701_C05_028M
S2701_C05_029E
S2701_C05_029M
S2701_C05_030E
S2701_C05_030M
S2701_C05_031E
S2701_C05_031M
S2701_C05_032E
S2701_C05_032M
S2701_C05_033E
S2701_C05_033M
S2701_C05_034E
S2701_C05_034M
S2701_C05_035E
S2701_C05_035M
S2701_C05_036E
S2701_C05_036M
S2701_C05_037E
S2701_C05_037M
S2701_C05_038E
S2701_C05_038M
S2701_C05_039E
S2701_C05_039M
S2701_C05_040E
S2701_C05_040M
S2701_C05_041E
S2701_C05_041M
S2701_C05_042E
S2701_C05_042M
S2701_C05_043E
S2701_C05_043M
S2701_C05_044E
S2701_C05_044M
S2701_C05_045E
S2701_C05_045M
S2701_C05_046E
S2701_C05_046M
S2701_C05_047E
S2701_C05_047M
S2701_C05_048E
S2701_C05_048M
S2701_C05_049E
S2701_C05_049M
S2701_C05_050E
S2701_C05_050M
S2701_C05_051E
S2701_C05_051M
S2701_C05_052E
S2701_C05_052M
S2701_C05_053E
S2701_C05_053M
S2701_C05_054E
S2701_C05_054M
S2701_C05_055E
S2701_C05_055M
S2701_C05_056E
S2701_C05_056M
S2701_C05_057E
S2701_C05_057M
S2701_C05_058E
S2701_C05_058M
S2701_C05_059E
S2701_C05_059M
S2701_C05_060E
S2701_C05_060M
S2701_C05_061E
S2701_C05_061M;
year=&fyear;
run;

data stack;
set stack temp;
run;
%mend;

%mread(2017)


data temp;
infile "&path.ACSST5Y2018.S2701-Data.csv"
	dsd missover firstobs=3;
input
GEO_ID:$14.
NAME:$120.
S2701_C01_001E
S2701_C01_001M
S2701_C01_002E
S2701_C01_002M
S2701_C01_003E
S2701_C01_003M
S2701_C01_004E
S2701_C01_004M
S2701_C01_005E
S2701_C01_005M
S2701_C01_006E
S2701_C01_006M
S2701_C01_007E
S2701_C01_007M
S2701_C01_008E
S2701_C01_008M
S2701_C01_009E
S2701_C01_009M
S2701_C01_010E
S2701_C01_010M
S2701_C01_011E
S2701_C01_011M
S2701_C01_012E
S2701_C01_012M
S2701_C01_013E
S2701_C01_013M
S2701_C01_014E
S2701_C01_014M
S2701_C01_015E
S2701_C01_015M
S2701_C01_016E
S2701_C01_016M
S2701_C01_017E
S2701_C01_017M
S2701_C01_018E
S2701_C01_018M
S2701_C01_019E
S2701_C01_019M
S2701_C01_020E
S2701_C01_020M
S2701_C01_021E
S2701_C01_021M
S2701_C01_022E
S2701_C01_022M
S2701_C01_023E
S2701_C01_023M
S2701_C01_024E
S2701_C01_024M
S2701_C01_025E
S2701_C01_025M
S2701_C01_026E
S2701_C01_026M
S2701_C01_027E
S2701_C01_027M
S2701_C01_028E
S2701_C01_028M
S2701_C01_029E
S2701_C01_029M
S2701_C01_030E
S2701_C01_030M
S2701_C01_031E
S2701_C01_031M
S2701_C01_032E
S2701_C01_032M
S2701_C01_033E
S2701_C01_033M
S2701_C01_034E
S2701_C01_034M
S2701_C01_035E
S2701_C01_035M
S2701_C01_036E
S2701_C01_036M
S2701_C01_037E
S2701_C01_037M
S2701_C01_038E
S2701_C01_038M
S2701_C01_039E
S2701_C01_039M
S2701_C01_040E
S2701_C01_040M
S2701_C01_041E
S2701_C01_041M
S2701_C01_042E
S2701_C01_042M
S2701_C01_043E
S2701_C01_043M
S2701_C01_044E
S2701_C01_044M
S2701_C01_045E
S2701_C01_045M
S2701_C01_046E
S2701_C01_046M
S2701_C01_047E
S2701_C01_047M
S2701_C01_048E
S2701_C01_048M
S2701_C01_049E
S2701_C01_049M
S2701_C01_050E
S2701_C01_050M
S2701_C01_051E
S2701_C01_051M
S2701_C01_052E
S2701_C01_052M
S2701_C01_053E
S2701_C01_053M
S2701_C01_054E
S2701_C01_054M
S2701_C01_055E
S2701_C01_055M
S2701_C01_056E
S2701_C01_056M
S2701_C01_057E
S2701_C01_057M
S2701_C01_058E
S2701_C01_058M
S2701_C01_059E
S2701_C01_059M
S2701_C01_060E
S2701_C01_060M
S2701_C01_061E
S2701_C01_061M
S2701_C02_001E
S2701_C02_001M
S2701_C03_001E
S2701_C03_001M
S2701_C04_001E
S2701_C04_001M
S2701_C05_001E
S2701_C05_001M
S2701_C02_002E
S2701_C02_002M
S2701_C03_002E
S2701_C03_002M
S2701_C04_002E
S2701_C04_002M
S2701_C05_002E
S2701_C05_002M
S2701_C02_003E
S2701_C02_003M
S2701_C03_003E
S2701_C03_003M
S2701_C04_003E
S2701_C04_003M
S2701_C05_003E
S2701_C05_003M
S2701_C02_004E
S2701_C02_004M
S2701_C03_004E
S2701_C03_004M
S2701_C04_004E
S2701_C04_004M
S2701_C05_004E
S2701_C05_004M
S2701_C02_005E
S2701_C02_005M
S2701_C03_005E
S2701_C03_005M
S2701_C04_005E
S2701_C04_005M
S2701_C05_005E
S2701_C05_005M
S2701_C02_006E
S2701_C02_006M
S2701_C03_006E
S2701_C03_006M
S2701_C04_006E
S2701_C04_006M
S2701_C05_006E
S2701_C05_006M
S2701_C02_007E
S2701_C02_007M
S2701_C03_007E
S2701_C03_007M
S2701_C04_007E
S2701_C04_007M
S2701_C05_007E
S2701_C05_007M
S2701_C02_008E
S2701_C02_008M
S2701_C03_008E
S2701_C03_008M
S2701_C04_008E
S2701_C04_008M
S2701_C05_008E
S2701_C05_008M
S2701_C02_009E
S2701_C02_009M
S2701_C03_009E
S2701_C03_009M
S2701_C04_009E
S2701_C04_009M
S2701_C05_009E
S2701_C05_009M
S2701_C02_010E
S2701_C02_010M
S2701_C03_010E
S2701_C03_010M
S2701_C04_010E
S2701_C04_010M
S2701_C05_010E
S2701_C05_010M
S2701_C02_011E
S2701_C02_011M
S2701_C03_011E
S2701_C03_011M
S2701_C04_011E
S2701_C04_011M
S2701_C05_011E
S2701_C05_011M
S2701_C02_012E
S2701_C02_012M
S2701_C03_012E
S2701_C03_012M
S2701_C04_012E
S2701_C04_012M
S2701_C05_012E
S2701_C05_012M
S2701_C02_013E
S2701_C02_013M
S2701_C03_013E
S2701_C03_013M
S2701_C04_013E
S2701_C04_013M
S2701_C05_013E
S2701_C05_013M
S2701_C02_014E
S2701_C02_014M
S2701_C03_014E
S2701_C03_014M
S2701_C04_014E
S2701_C04_014M
S2701_C05_014E
S2701_C05_014M
S2701_C02_015E
S2701_C02_015M
S2701_C03_015E
S2701_C03_015M
S2701_C04_015E
S2701_C04_015M
S2701_C05_015E
S2701_C05_015M
S2701_C02_016E
S2701_C02_016M
S2701_C03_016E
S2701_C03_016M
S2701_C04_016E
S2701_C04_016M
S2701_C05_016E
S2701_C05_016M
S2701_C02_017E
S2701_C02_017M
S2701_C03_017E
S2701_C03_017M
S2701_C04_017E
S2701_C04_017M
S2701_C05_017E
S2701_C05_017M
S2701_C02_018E
S2701_C02_018M
S2701_C03_018E
S2701_C03_018M
S2701_C04_018E
S2701_C04_018M
S2701_C05_018E
S2701_C05_018M
S2701_C02_019E
S2701_C02_019M
S2701_C03_019E
S2701_C03_019M
S2701_C04_019E
S2701_C04_019M
S2701_C05_019E
S2701_C05_019M
S2701_C02_020E
S2701_C02_020M
S2701_C03_020E
S2701_C03_020M
S2701_C04_020E
S2701_C04_020M
S2701_C05_020E
S2701_C05_020M
S2701_C02_021E
S2701_C02_021M
S2701_C03_021E
S2701_C03_021M
S2701_C04_021E
S2701_C04_021M
S2701_C05_021E
S2701_C05_021M
S2701_C02_022E
S2701_C02_022M
S2701_C03_022E
S2701_C03_022M
S2701_C04_022E
S2701_C04_022M
S2701_C05_022E
S2701_C05_022M
S2701_C02_023E
S2701_C02_023M
S2701_C03_023E
S2701_C03_023M
S2701_C04_023E
S2701_C04_023M
S2701_C05_023E
S2701_C05_023M
S2701_C02_024E
S2701_C02_024M
S2701_C03_024E
S2701_C03_024M
S2701_C04_024E
S2701_C04_024M
S2701_C05_024E
S2701_C05_024M
S2701_C02_025E
S2701_C02_025M
S2701_C03_025E
S2701_C03_025M
S2701_C04_025E
S2701_C04_025M
S2701_C05_025E
S2701_C05_025M
S2701_C02_026E
S2701_C02_026M
S2701_C03_026E
S2701_C03_026M
S2701_C04_026E
S2701_C04_026M
S2701_C05_026E
S2701_C05_026M
S2701_C02_027E
S2701_C02_027M
S2701_C03_027E
S2701_C03_027M
S2701_C04_027E
S2701_C04_027M
S2701_C05_027E
S2701_C05_027M
S2701_C02_028E
S2701_C02_028M
S2701_C03_028E
S2701_C03_028M
S2701_C04_028E
S2701_C04_028M
S2701_C05_028E
S2701_C05_028M
S2701_C02_029E
S2701_C02_029M
S2701_C03_029E
S2701_C03_029M
S2701_C04_029E
S2701_C04_029M
S2701_C05_029E
S2701_C05_029M
S2701_C02_030E
S2701_C02_030M
S2701_C03_030E
S2701_C03_030M
S2701_C04_030E
S2701_C04_030M
S2701_C05_030E
S2701_C05_030M
S2701_C02_031E
S2701_C02_031M
S2701_C03_031E
S2701_C03_031M
S2701_C04_031E
S2701_C04_031M
S2701_C05_031E
S2701_C05_031M
S2701_C02_032E
S2701_C02_032M
S2701_C03_032E
S2701_C03_032M
S2701_C04_032E
S2701_C04_032M
S2701_C05_032E
S2701_C05_032M
S2701_C02_033E
S2701_C02_033M
S2701_C03_033E
S2701_C03_033M
S2701_C04_033E
S2701_C04_033M
S2701_C05_033E
S2701_C05_033M
S2701_C02_034E
S2701_C02_034M
S2701_C03_034E
S2701_C03_034M
S2701_C04_034E
S2701_C04_034M
S2701_C05_034E
S2701_C05_034M
S2701_C02_035E
S2701_C02_035M
S2701_C03_035E
S2701_C03_035M
S2701_C04_035E
S2701_C04_035M
S2701_C05_035E
S2701_C05_035M
S2701_C02_036E
S2701_C02_036M
S2701_C03_036E
S2701_C03_036M
S2701_C04_036E
S2701_C04_036M
S2701_C05_036E
S2701_C05_036M
S2701_C02_037E
S2701_C02_037M
S2701_C03_037E
S2701_C03_037M
S2701_C04_037E
S2701_C04_037M
S2701_C05_037E
S2701_C05_037M
S2701_C02_038E
S2701_C02_038M
S2701_C03_038E
S2701_C03_038M
S2701_C04_038E
S2701_C04_038M
S2701_C05_038E
S2701_C05_038M
S2701_C02_039E
S2701_C02_039M
S2701_C03_039E
S2701_C03_039M
S2701_C04_039E
S2701_C04_039M
S2701_C05_039E
S2701_C05_039M
S2701_C02_040E
S2701_C02_040M
S2701_C03_040E
S2701_C03_040M
S2701_C04_040E
S2701_C04_040M
S2701_C05_040E
S2701_C05_040M
S2701_C02_041E
S2701_C02_041M
S2701_C03_041E
S2701_C03_041M
S2701_C04_041E
S2701_C04_041M
S2701_C05_041E
S2701_C05_041M
S2701_C02_042E
S2701_C02_042M
S2701_C03_042E
S2701_C03_042M
S2701_C04_042E
S2701_C04_042M
S2701_C05_042E
S2701_C05_042M
S2701_C02_043E
S2701_C02_043M
S2701_C03_043E
S2701_C03_043M
S2701_C04_043E
S2701_C04_043M
S2701_C05_043E
S2701_C05_043M
S2701_C02_044E
S2701_C02_044M
S2701_C03_044E
S2701_C03_044M
S2701_C04_044E
S2701_C04_044M
S2701_C05_044E
S2701_C05_044M
S2701_C02_045E
S2701_C02_045M
S2701_C03_045E
S2701_C03_045M
S2701_C04_045E
S2701_C04_045M
S2701_C05_045E
S2701_C05_045M
S2701_C02_046E
S2701_C02_046M
S2701_C03_046E
S2701_C03_046M
S2701_C04_046E
S2701_C04_046M
S2701_C05_046E
S2701_C05_046M
S2701_C02_047E
S2701_C02_047M
S2701_C03_047E
S2701_C03_047M
S2701_C04_047E
S2701_C04_047M
S2701_C05_047E
S2701_C05_047M
S2701_C02_048E
S2701_C02_048M
S2701_C03_048E
S2701_C03_048M
S2701_C04_048E
S2701_C04_048M
S2701_C05_048E
S2701_C05_048M
S2701_C02_049E
S2701_C02_049M
S2701_C03_049E
S2701_C03_049M
S2701_C04_049E
S2701_C04_049M
S2701_C05_049E
S2701_C05_049M
S2701_C02_050E
S2701_C02_050M
S2701_C03_050E
S2701_C03_050M
S2701_C04_050E
S2701_C04_050M
S2701_C05_050E
S2701_C05_050M
S2701_C02_051E
S2701_C02_051M
S2701_C03_051E
S2701_C03_051M
S2701_C04_051E
S2701_C04_051M
S2701_C05_051E
S2701_C05_051M
S2701_C02_052E
S2701_C02_052M
S2701_C03_052E
S2701_C03_052M
S2701_C04_052E
S2701_C04_052M
S2701_C05_052E
S2701_C05_052M
S2701_C02_053E
S2701_C02_053M
S2701_C03_053E
S2701_C03_053M
S2701_C04_053E
S2701_C04_053M
S2701_C05_053E
S2701_C05_053M
S2701_C02_054E
S2701_C02_054M
S2701_C03_054E
S2701_C03_054M
S2701_C04_054E
S2701_C04_054M
S2701_C05_054E
S2701_C05_054M
S2701_C02_055E
S2701_C02_055M
S2701_C03_055E
S2701_C03_055M
S2701_C04_055E
S2701_C04_055M
S2701_C05_055E
S2701_C05_055M
S2701_C02_056E
S2701_C02_056M
S2701_C03_056E
S2701_C03_056M
S2701_C04_056E
S2701_C04_056M
S2701_C05_056E
S2701_C05_056M
S2701_C02_057E
S2701_C02_057M
S2701_C03_057E
S2701_C03_057M
S2701_C04_057E
S2701_C04_057M
S2701_C05_057E
S2701_C05_057M
S2701_C02_058E
S2701_C02_058M
S2701_C03_058E
S2701_C03_058M
S2701_C04_058E
S2701_C04_058M
S2701_C05_058E
S2701_C05_058M
S2701_C02_059E
S2701_C02_059M
S2701_C03_059E
S2701_C03_059M
S2701_C04_059E
S2701_C04_059M
S2701_C05_059E
S2701_C05_059M
S2701_C02_060E
S2701_C02_060M
S2701_C03_060E
S2701_C03_060M
S2701_C04_060E
S2701_C04_060M
S2701_C05_060E
S2701_C05_060M
S2701_C02_061E
S2701_C02_061M
S2701_C03_061E
S2701_C03_061M
S2701_C04_061E
S2701_C04_061M
S2701_C05_061E
S2701_C05_061M
;
year=2018;
run;

data stack;
set stack temp;
run;


%mread(2019)
%mread(2020)
%mread(2021)
%mread(2022)


data stack;
length s_name $ 50;
set stack;
geofips=substr(geo_id,10,5);
s_name=scan(name,2,',');
drop
S2701_C01_001M
S2701_C01_002M
S2701_C01_003M
S2701_C01_004M
S2701_C01_005M
S2701_C01_006M
S2701_C01_007M
S2701_C01_008M
S2701_C01_009M
S2701_C01_010M
S2701_C01_011M
S2701_C01_012M
S2701_C01_013M
S2701_C01_014M
S2701_C01_015M
S2701_C01_016M
S2701_C01_017M
S2701_C01_018M
S2701_C01_019M
S2701_C01_020M
S2701_C01_021M
S2701_C01_022M
S2701_C01_023M
S2701_C01_024M
S2701_C01_025M
S2701_C01_026M
S2701_C01_027M
S2701_C01_028M
S2701_C01_029M
S2701_C01_030M
S2701_C01_031M
S2701_C01_032M
S2701_C01_033M
S2701_C01_034M
S2701_C01_035M
S2701_C01_036M
S2701_C01_037M
S2701_C01_038M
S2701_C01_039M
S2701_C01_040M
S2701_C01_041M
S2701_C01_042M
S2701_C01_043M
S2701_C01_044M
S2701_C01_045M
S2701_C01_046M
S2701_C01_047M
S2701_C01_048M
S2701_C01_049M
S2701_C01_050M
S2701_C01_051M
S2701_C01_052M
S2701_C01_053M
S2701_C01_054M
S2701_C01_055M
S2701_C01_056M
S2701_C01_057M
S2701_C01_058M
S2701_C01_059M
S2701_C01_060M
S2701_C01_061M
S2701_C02_001M
S2701_C02_002M
S2701_C02_003M
S2701_C02_004M
S2701_C02_005M
S2701_C02_006M
S2701_C02_007M
S2701_C02_008M
S2701_C02_009M
S2701_C02_010M
S2701_C02_011M
S2701_C02_012M
S2701_C02_013M
S2701_C02_014M
S2701_C02_015M
S2701_C02_016M
S2701_C02_017M
S2701_C02_018M
S2701_C02_019M
S2701_C02_020M
S2701_C02_021M
S2701_C02_022M
S2701_C02_023M
S2701_C02_024M
S2701_C02_025M
S2701_C02_026M
S2701_C02_027M
S2701_C02_028M
S2701_C02_029M
S2701_C02_030M
S2701_C02_031M
S2701_C02_032M
S2701_C02_033M
S2701_C02_034M
S2701_C02_035M
S2701_C02_036M
S2701_C02_037M
S2701_C02_038M
S2701_C02_039M
S2701_C02_040M
S2701_C02_041M
S2701_C02_042M
S2701_C02_043M
S2701_C02_044M
S2701_C02_045M
S2701_C02_046M
S2701_C02_047M
S2701_C02_048M
S2701_C02_049M
S2701_C02_050M
S2701_C02_051M
S2701_C02_052M
S2701_C02_053M
S2701_C02_054M
S2701_C02_055M
S2701_C02_056M
S2701_C02_057M
S2701_C02_058M
S2701_C02_059M
S2701_C02_060M
S2701_C02_061M
S2701_C03_001M
S2701_C03_002M
S2701_C03_003M
S2701_C03_004M
S2701_C03_005M
S2701_C03_006M
S2701_C03_007M
S2701_C03_008M
S2701_C03_009M
S2701_C03_010M
S2701_C03_011M
S2701_C03_012M
S2701_C03_013M
S2701_C03_014M
S2701_C03_015M
S2701_C03_016M
S2701_C03_017M
S2701_C03_018M
S2701_C03_019M
S2701_C03_020M
S2701_C03_021M
S2701_C03_022M
S2701_C03_023M
S2701_C03_024M
S2701_C03_025M
S2701_C03_026M
S2701_C03_027M
S2701_C03_028M
S2701_C03_029M
S2701_C03_030M
S2701_C03_031M
S2701_C03_032M
S2701_C03_033M
S2701_C03_034M
S2701_C03_035M
S2701_C03_036M
S2701_C03_037M
S2701_C03_038M
S2701_C03_039M
S2701_C03_040M
S2701_C03_041M
S2701_C03_042M
S2701_C03_043M
S2701_C03_044M
S2701_C03_045M
S2701_C03_046M
S2701_C03_047M
S2701_C03_048M
S2701_C03_049M
S2701_C03_050M
S2701_C03_051M
S2701_C03_052M
S2701_C03_053M
S2701_C03_054M
S2701_C03_055M
S2701_C03_056M
S2701_C03_057M
S2701_C03_058M
S2701_C03_059M
S2701_C03_060M
S2701_C03_061M
S2701_C04_001M
S2701_C04_002M
S2701_C04_003M
S2701_C04_004M
S2701_C04_005M
S2701_C04_006M
S2701_C04_007M
S2701_C04_008M
S2701_C04_009M
S2701_C04_010M
S2701_C04_011M
S2701_C04_012M
S2701_C04_013M
S2701_C04_014M
S2701_C04_015M
S2701_C04_016M
S2701_C04_017M
S2701_C04_018M
S2701_C04_019M
S2701_C04_020M
S2701_C04_021M
S2701_C04_022M
S2701_C04_023M
S2701_C04_024M
S2701_C04_025M
S2701_C04_026M
S2701_C04_027M
S2701_C04_028M
S2701_C04_029M
S2701_C04_030M
S2701_C04_031M
S2701_C04_032M
S2701_C04_033M
S2701_C04_034M
S2701_C04_035M
S2701_C04_036M
S2701_C04_037M
S2701_C04_038M
S2701_C04_039M
S2701_C04_040M
S2701_C04_041M
S2701_C04_042M
S2701_C04_043M
S2701_C04_044M
S2701_C04_045M
S2701_C04_046M
S2701_C04_047M
S2701_C04_048M
S2701_C04_049M
S2701_C04_050M
S2701_C04_051M
S2701_C04_052M
S2701_C04_053M
S2701_C04_054M
S2701_C04_055M
S2701_C04_056M
S2701_C04_057M
S2701_C04_058M
S2701_C04_059M
S2701_C04_060M
S2701_C04_061M
S2701_C05_001M
S2701_C05_002M
S2701_C05_003M
S2701_C05_004M
S2701_C05_005M
S2701_C05_006M
S2701_C05_007M
S2701_C05_008M
S2701_C05_009M
S2701_C05_010M
S2701_C05_011M
S2701_C05_012M
S2701_C05_013M
S2701_C05_014M
S2701_C05_015M
S2701_C05_016M
S2701_C05_017M
S2701_C05_018M
S2701_C05_019M
S2701_C05_020M
S2701_C05_021M
S2701_C05_022M
S2701_C05_023M
S2701_C05_024M
S2701_C05_025M
S2701_C05_026M
S2701_C05_027M
S2701_C05_028M
S2701_C05_029M
S2701_C05_030M
S2701_C05_031M
S2701_C05_032M
S2701_C05_033M
S2701_C05_034M
S2701_C05_035M
S2701_C05_036M
S2701_C05_037M
S2701_C05_038M
S2701_C05_039M
S2701_C05_040M
S2701_C05_041M
S2701_C05_042M
S2701_C05_043M
S2701_C05_044M
S2701_C05_045M
S2701_C05_046M
S2701_C05_047M
S2701_C05_048M
S2701_C05_049M
S2701_C05_050M
S2701_C05_051M
S2701_C05_052M
S2701_C05_053M
S2701_C05_054M
S2701_C05_055M
S2701_C05_056M
S2701_C05_057M
S2701_C05_058M
S2701_C05_059M
S2701_C05_060M
S2701_C05_061M
S2701_C01_025E
S2701_C01_026E
S2701_C01_027E
S2701_C01_028E
S2701_C01_029E
S2701_C01_030E
S2701_C01_031E
S2701_C01_032E
S2701_C01_033E
S2701_C01_034E
S2701_C01_035E
S2701_C01_036E
S2701_C01_037E
S2701_C01_038E
S2701_C01_039E
S2701_C01_040E
S2701_C01_041E
S2701_C01_047E
S2701_C01_048E
S2701_C01_049E
S2701_C01_050E
S2701_C01_057E
S2701_C01_058E
S2701_C01_059E
S2701_C01_060E
S2701_C01_061E
S2701_C02_025E
S2701_C02_026E
S2701_C02_027E
S2701_C02_028E
S2701_C02_029E
S2701_C02_030E
S2701_C02_031E
S2701_C02_032E
S2701_C02_033E
S2701_C02_034E
S2701_C02_035E
S2701_C02_036E
S2701_C02_037E
S2701_C02_038E
S2701_C02_039E
S2701_C02_040E
S2701_C02_041E
S2701_C02_047E
S2701_C02_048E
S2701_C02_049E
S2701_C02_050E
S2701_C02_057E
S2701_C02_058E
S2701_C02_059E
S2701_C02_060E
S2701_C02_061E
S2701_C03_025E
S2701_C03_026E
S2701_C03_027E
S2701_C03_028E
S2701_C03_029E
S2701_C03_030E
S2701_C03_031E
S2701_C03_032E
S2701_C03_033E
S2701_C03_034E
S2701_C03_035E
S2701_C03_036E
S2701_C03_037E
S2701_C03_038E
S2701_C03_039E
S2701_C03_040E
S2701_C03_041E
S2701_C03_047E
S2701_C03_048E
S2701_C03_049E
S2701_C03_050E
S2701_C03_057E
S2701_C03_058E
S2701_C03_059E
S2701_C03_060E
S2701_C03_061E
S2701_C04_025E
S2701_C04_026E
S2701_C04_027E
S2701_C04_028E
S2701_C04_029E
S2701_C04_030E
S2701_C04_031E
S2701_C04_032E
S2701_C04_033E
S2701_C04_034E
S2701_C04_035E
S2701_C04_036E
S2701_C04_037E
S2701_C04_038E
S2701_C04_039E
S2701_C04_040E
S2701_C04_041E
S2701_C04_047E
S2701_C04_048E
S2701_C04_049E
S2701_C04_050E
S2701_C04_057E
S2701_C04_058E
S2701_C04_059E
S2701_C04_060E
S2701_C04_061E
S2701_C05_025E
S2701_C05_026E
S2701_C05_027E
S2701_C05_028E
S2701_C05_029E
S2701_C05_030E
S2701_C05_031E
S2701_C05_032E
S2701_C05_033E
S2701_C05_034E
S2701_C05_035E
S2701_C05_036E
S2701_C05_037E
S2701_C05_038E
S2701_C05_039E
S2701_C05_040E
S2701_C05_041E
S2701_C05_047E
S2701_C05_048E
S2701_C05_049E
S2701_C05_050E
S2701_C05_057E
S2701_C05_058E
S2701_C05_059E
S2701_C05_060E
S2701_C05_061E
;
run;

data tpr.term_project_data (compress=yes);
set stack;
if year=1990 then delete;
run;
* Calculating Labor Force Participation Rate;
*labor force variables: S2701_C01_043E / S2701_C01_042E;
data laborforce_participation;
set tpr.term_project_data;
	labor_force = S2701_C01_043E;
	working_age = S2701_C01_042E;
	if working_age > 0 then participation_rate = (labor_force / working_age) * 100;
	else participation_rate = .;
run;
*Creating controls; 
data new_set;
set laborforce_participation;
* dependent variable;
	percent_uninsured = S2701_C05_001E;
* calculating household income;
	household_income = S2701_C01_051E;
* calculating the unemployment rate and handling missing values; 
	if S2701_C01_042E > 0 then unemployment_rate = (S2701_C01_045E / S2701_C01_042E) * 100;
		else unemployment_rate = .;
* calculating percentage of age groups; 
	total_age = sum(S2701_C01_002E, S2701_C01_003E, S2701_C01_004E, S2701_C01_005E, S2701_C01_006E, S2701_C01_007E, S2701_C01_008E, S2701_C01_009E, S2701_C01_010E);
	if total_age > 0 then do;
		percent_young = ((S2701_C01_004E + S2701_C01_005E) / total_age) * 100; *19-34;
		percent_old = ((S2701_C01_009E + S2701_C01_010E) / total_age) * 100; *65+;
	end;
		else do;
		percent_young = .;
		percent_old = .;
	end;
* calculating the population of hispanic white;
	hispanic_pop = S2701_C01_016E - S2701_C01_024E;
* calculating the total population;
	total_race = sum(S2701_C01_024E, S2701_C01_022E, S2701_C01_021E, S2701_C01_020E, S2701_C01_019E, S2701_C01_018E, S2701_C01_017E) + hispanic_pop;
* calculating the percentage of white;
	if total_race > 0 then perc_white = (S2701_C01_024E / total_race) * 100;
		else perc_white = .;
*calculating percent female;
	total_gender = S2701_C01_015E + S2701_C01_014E;
	if total_gender > 0 then perc_female = (S2701_C01_015E / (S2701_C01_015E + S2701_C01_014E)) * 100;
		else perc_female = .;
run; 
data total_set;
    set new_set;

    /* Default value for Medicaid Expansion */
    Medicaid_Expanded = 0;

   /* Medicaid Expansion by state and year */
if strip(upcase(s_name)) = "ALABAMA" then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "ALASKA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "ARIZONA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "ARKANSAS" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "CALIFORNIA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "COLORADO" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "CONNECTICUT" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "DELAWARE" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "DISTRICT OF COLUMBIA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "FLORIDA" and Year in (2017:2022) then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "GEORGIA" and Year in (2017:2022) then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "HAWAII" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "IDAHO" then do;
    if Year in (2017, 2018, 2019) then Medicaid_Expanded = 0;
    else if Year >= 2020 then Medicaid_Expanded = 1;
end;
else if strip(upcase(s_name)) = "INDIANA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "IOWA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "KANSAS" and Year in (2017:2022) then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "KENTUCKY" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "LOUISIANA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "MAINE" then do;
    if Year in (2017, 2018) then Medicaid_Expanded = 0;
    else if Year >= 2019 then Medicaid_Expanded = 1;
end;
else if strip(upcase(s_name)) = "MARYLAND" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "MASSACHUSETTS" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "MINNESOTA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "MISSISSIPPI" then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "MISSOURI" then do;
    if Year in (2017:2020) then Medicaid_Expanded = 0;
    else if Year >= 2021 then Medicaid_Expanded = 1;
end;
else if strip(upcase(s_name)) = "MONTANA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "NEBRASKA" then do;
    if Year in (2017, 2018, 2019) then Medicaid_Expanded = 0;
    else if Year >= 2020 then Medicaid_Expanded = 1;
end;
else if strip(upcase(s_name)) = "NEVADA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "NEW HAMPSHIRE" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "NEW JERSEY" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "NEW MEXICO" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "NEW YORK" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "NORTH CAROLINA" then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "NORTH DAKOTA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "OHIO" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "OKLAHOMA" then do;
    if Year in (2017:2020) then Medicaid_Expanded = 0;
    else if Year >= 2021 then Medicaid_Expanded = 1;
end;
else if strip(upcase(s_name)) = "OREGON" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "PENNSYLVANIA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "PUERTO RICO" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "RHODE ISLAND" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "SOUTH CAROLINA" then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "SOUTH DAKOTA" then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "TENNESSEE" then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "TEXAS" then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "UTAH" then do;
    if Year in (2017, 2018, 2019) then Medicaid_Expanded = 0;
    else if Year >= 2020 then Medicaid_Expanded = 1;
end;
else if strip(upcase(s_name)) = "VERMONT" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "VIRGINIA" then do;
    if Year in (2017, 2018) then Medicaid_Expanded = 0;
    else if Year >= 2019 then Medicaid_Expanded = 1;
end;
else if strip(upcase(s_name)) = "WASHINGTON" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "WEST VIRGINIA" then Medicaid_Expanded = 1;
else if strip(upcase(s_name)) = "WISCONSIN" then Medicaid_Expanded = 0;
else if strip(upcase(s_name)) = "WYOMING" then Medicaid_Expanded = 0;

run;

 proc export data=total_set
	outfile="H:\673 Homework\term_project_data_cleaned.csv"
	dbms=csv
	replace;
run;
    
   








     




